#exec --no-startup-id nitrogen

#{{{ Variables
  set $mod Mod4
  set $sup Mod1

  set $left h
  set $right l
  set $down j
  set $up k

  set $resources_dir 
  set $bg1 "$HOME/dotfiles/resources/wallpaper.jpg"
  set $bg2 "$HOME/dotfiles/resources/wallpaper.jpg"
  set $lock_bg "$HOME/dotfiles/resources/wallpaper.jpg"

  set $term "alacritty"
  set $browser "qutebrowser"

  set $primary_display "HDMI2"
  set $minor_display "eDP1"

  set $ws_alt 0
  set $ws_sys 1
  set $ws_dev 2
  set $ws_www 3
  set $ws_msg 4
  set $ws_obs 5
#}}}

#{{{ Autorun
  exec --no-startup-id picom
  exec --no-startup-id dunst
  exec --no-startup-id $HOME/.launchers/polybar.sh
  exec --no-startup-id $HOME/.launchers/bg.sh $bg1 $bg2
  exec --no-startup-id $HOME/.launchers/keyboard-config.sh
  exec --no-startup-id flameshot
  exec --no-startup-id xcape -d -t 200
  exec --no-startup-id pulseaudio --daemonize=no --exit-idle-time=-1
  exec $term
#}}}

#{{{ Base config
  popup_during_fullscreen leave_fullscreen
  focus_follows_mouse no
  # mouse_warping none
#}}}

#{{{ Theme
  font pango:Ubuntu Mono 9
  # 1 pixel border for all windows
  for_window [tiling] border pixel 2
  # focus border colors
  set $focus_color #3b4252
  set $focus_foreground_color #eceff4
  client.focused $focus_color $focus_color $focus_foreground_color $focus_color $focus_color
#}}}

##{{{ Bindings

  #{{{ Specials bindings
    # reload i3 config
    bindsym $mod+Shift+r reload

    bindsym XF86AudioLowerVolume exec --no-startup-id amixer -q sset Master 2%-
    bindsym XF86AudioRaiseVolume exec --no-startup-id amixer -q sset Master 2%+
    bindsym XF86AudioMute exec --no-startup-id amixer set Master 1+ toggle
    bindsym XF86MonBrightnessUp exec --no-startup-id brightnessctl set 5%+
    bindsym XF86MonBrightnessDown exec --no-startup-id brightnessctl set 5%-

    bindsym $mod+bracketleft exec --no-startup-id xkb-switch -s 'us(dvorak)'
    bindsym $mod+bracketright exec --no-startup-id xkb-switch -s 'ru'
  #}}}
  
  #{{{ Window navigation and manipulation
    # kill focused window
    bindsym $mod+Tab kill

    # toggle between screens
    bindsym $mod+comma focus output left
    # toggle botween two last workspaces
    bindsym $mod+period workspace back_and_forth

    # change focus
    bindsym $mod+$left focus left
    bindsym $mod+$down focus down
    bindsym $mod+$up focus up
    bindsym $mod+$right focus right

    # move focused window
    bindsym $mod+Shift+$left move left
    bindsym $mod+Shift+$down move down
    bindsym $mod+Shift+$up move up
    bindsym $mod+Shift+$right move right

    bindsym $mod+Shift+p exec $HOME/.launchers/lock.sh -i $lock_bg

    # change focus between tiling / floating windows
    # bindsym $mod+space focus mode_toggle
    # $mod+Mouse move resize or move float window
    floating_modifier $mod

    # focus the parent container
    bindsym $mod+a focus parent

    bindsym $mod+w mode "win_layout"
    mode "win_layout" {
      # split in horizontal/vertical orientation
      bindsym $mod+h split h; mode "default"
      bindsym h split h; mode "default"

      bindsym $mod+v split v; mode "default"
      bindsym v split v; mode "default"

      # change container layout (stacked, tabbed, toggle split)
      bindsym $mod+s layout stacking border none; mode "default"
      bindsym s layout stacking border none; mode "default"
      bindsym $mod+t layout tabbed border none; mode "default"
      bindsym t layout tabbed border none; mode "default"
      #bindsym $mod+e layout toggle split

      # enter fullscreen mode for the focused container
      bindsym $mod+f fullscreen toggle; mode "default"
      bindsym f fullscreen toggle; mode "default"

      # toggle tiling / floating
      bindsym $mod+Shift+f floating toggle; mode "default"
      bindsym Shift+f floating toggle; mode "default"

      bindsym Escape mode "default"
      bindsym space mode "default"
    }
  #}}}

  #{{{ Workspace navigation and manipulation
    bindsym $mod+g mode "ws_navigation"
    mode "ws_navigation" {
      bindsym $mod+a workspace $ws_alt; mode "default"
      bindsym $mod+s workspace $ws_sys; mode "default"
      bindsym $mod+m workspace $ws_msg; mode "default"
      bindsym $mod+d workspace $ws_dev; mode "default"
      bindsym $mod+w workspace $ws_www; mode "default"
	  bindsym $mod+o workspace $ws_obs; mode "default"

      bindsym a workspace $ws_alt; mode "default"
      bindsym s workspace $ws_sys; mode "default"
      bindsym m workspace $ws_msg; mode "default"
      bindsym d workspace $ws_dev; mode "default"
      bindsym w workspace $ws_www; mode "default"
	  bindsym o workspace $ws_obs; mode "default"

      bindsym Escape mode "default"
      bindsym space mode "default"
    }

    bindsym $mod+m mode "ws_manipulation" 
    mode "ws_manipulation" {
      bindsym $mod+a move container to workspace $ws_alt; mode "default"
      bindsym $mod+s move container to workspace $ws_sys; mode "default"
      bindsym $mod+m move container to workspace $ws_msg; mode "default"
      bindsym $mod+d move container to workspace $ws_dev; mode "default"
      bindsym $mod+w move container to workspace $ws_www; mode "default"
	  bindsym $mod+o move container to workspace $ws_obs; mode "default"

      bindsym a move container to workspace $ws_alt; mode "default"
      bindsym s move container to workspace $ws_sys; mode "default"
      bindsym m move container to workspace $ws_msg; mode "default"
      bindsym d move container to workspace $ws_dev; mode "default"
      bindsym w move container to workspace $ws_www; mode "default"
	  bindsym o move container to workspace $ws_obs; mode "default"

      bindsym Escape mode "default"
      bindsym space mode "default"
    }

    # move workspace to other display
    bindsym $mod+Control+h move workspace to output left
    bindsym $mod+Control+l move workspace to output right
  #}}}
  
  #{{{ Browser workflow
	bindsym $mod+b mode "web_surf"
	mode "web_surf" {
		bindsym $mod+g workspace $ws_www; exec xdg-open "https://google.com"; mode "default"
		bindsym g workspace $ws_www; exec xdg-open "https://google.com"; mode "default"

		bindsym $mod+h workspace $ws_www; exec xdg-open "https://habr.com"; mode "default"
		bindsym h workspace $ws_www; exec xdg-open "https://habr.com"; mode "default"

		bindsym Escape mode "default"
		bindsym space mode "default"
	}
  #}}}

  #{{{ Default programs
    # start a terminal
    bindsym $mod+Return exec $term
    # make screenshot
    bindsym Print exec flameshot gui
    # start rofi (a program launcher)
    bindsym $mod+space exec rofi -show drun -modi drun # -theme ~/.config/rofi/gruvbox-dark.rasi

    bindsym $mod+s mode "app_start"
    mode "app_start" {
      bindsym $mod+t workspace $ws_sys; exec $term; mode "default"
      bindsym t workspace $ws_sys; exec $term; mode "default"

      bindsym $mod+b workspace $ws_www; exec $browser; mode "default"
      bindsym b workspace $ws_www; exec $browser; mode "default"

      bindsym $mod+p workspace $ws_dev; exec pycharm; mode "default"
      bindsym p workspace $ws_dev; exec pycharm; mode "default"

      bindsym Escape mode "default"
      bindsym space mode "default"
    }
  #}}}
  
  #{{{ RESIZE MODE
    bindsym $mod+r mode "resize"
    # resize window (you can also use the mouse for that)
    mode "resize" {
            # These bindings trigger as soon as you enter the resize mode

            # Pressing left will shrink the window’s width.
            # Pressing right will grow the window’s width.
            # Pressing up will shrink the window’s height.
            # Pressing down will grow the window’s height.
            bindsym $left resize shrink width 15 px or 5 ppt
            bindsym $down resize grow height 15 px or 5 ppt
            bindsym $up resize shrink height 15 px or 5 ppt
            bindsym $right resize grow width 15 px or 5 ppt

            bindsym Escape mode "default"
            bindsym space mode "default"
    }
  #}}}

#}}}

